graph TB
    subgraph "DATA SOURCE"
        API[PokeAPI<br/>pokeapi.co]
    end
    
    subgraph "EXTRACT & LOAD"
        PY[Python Extractor<br/>extract_pokemon.py]
        API -->|HTTP Requests| PY
    end
    
    subgraph "RAW LAYER - DuckDB"
        RAW_P[raw.pokemon<br/>Base Info]
        RAW_T[raw.pokemon_types<br/>Types]
        RAW_A[raw.pokemon_abilities<br/>Abilities]
        RAW_S[raw.pokemon_stats<br/>Stats]
        
        PY -->|INSERT| RAW_P
        PY -->|INSERT| RAW_T
        PY -->|INSERT| RAW_A
        PY -->|INSERT| RAW_S
    end
    
    subgraph "STAGING LAYER - dbt Views"
        STG_P[stg_pokemon<br/>Cleaned + Calculated]
        STG_T[stg_pokemon_types<br/>Cleaned]
        STG_A[stg_pokemon_abilities<br/>Cleaned]
        STG_S[stg_pokemon_stats<br/>Cleaned]
        
        RAW_P -->|dbt| STG_P
        RAW_T -->|dbt| STG_T
        RAW_A -->|dbt| STG_A
        RAW_S -->|dbt| STG_S
    end
    
    subgraph "MARTS LAYER - dbt Tables"
        FCT_P[fct_pokemon<br/>Complete Fact Table]
        DIM_T[dim_type_analysis<br/>Type Analytics]
        FCT_R[fct_stat_rankings<br/>Stat Rankings]
        
        STG_P -->|JOIN + PIVOT| FCT_P
        STG_T -->|JOIN + PIVOT| FCT_P
        STG_A -->|JOIN + AGG| FCT_P
        STG_S -->|JOIN + PIVOT| FCT_P
        
        STG_T -->|AGGREGATE| DIM_T
        STG_P -->|JOIN| DIM_T
        
        STG_S -->|RANK + TIER| FCT_R
        STG_P -->|JOIN| FCT_R
    end
    
    subgraph "CONSUMPTION"
        QUERY[SQL Queries]
        DOCS[dbt Documentation]
        ANALYSIS[Analysis Scripts]
        
        FCT_P --> QUERY
        DIM_T --> QUERY
        FCT_R --> QUERY
        
        FCT_P -.-> DOCS
        DIM_T -.-> DOCS
        FCT_R -.-> DOCS
        
        FCT_P --> ANALYSIS
        DIM_T --> ANALYSIS
        FCT_R --> ANALYSIS
    end
    
    style API fill:#e1f5ff
    style PY fill:#fff4e6
    style RAW_P fill:#f3e5f5
    style RAW_T fill:#f3e5f5
    style RAW_A fill:#f3e5f5
    style RAW_S fill:#f3e5f5
    style STG_P fill:#e8f5e9
    style STG_T fill:#e8f5e9
    style STG_A fill:#e8f5e9
    style STG_S fill:#e8f5e9
    style FCT_P fill:#fff9c4
    style DIM_T fill:#fff9c4
    style FCT_R fill:#fff9c4
    style QUERY fill:#ffebee
    style DOCS fill:#ffebee
    style ANALYSIS fill:#ffebee
